// Script để tải SDK ZEGO chính thức từ CDN
(function () {
  console.log("Đang tải SDK ZEGO WebRTC chính thức từ CDN...");

  // Tạo một script element để tải SDK từ CDN
  const script = document.createElement("script");
  script.src =
    "https://cdn.jsdelivr.net/npm/zego-express-engine-webrtc@2.24.5/ZegoExpressWebRTC.min.js";
  script.async = true;
  script.crossOrigin = "anonymous";

  // Xử lý sự kiện khi tải xong SDK
  script.onload = function () {
    console.log("✅ Tải SDK ZEGO WebRTC chính thức thành công!");

    // Thông báo cho các component đang chờ SDK
    if (typeof window !== "undefined") {
      const zegoLoadedEvent = new Event("zegoSDKLoaded");
      window.dispatchEvent(zegoLoadedEvent);

      // Đánh dấu SDK đã được tải thành công
      window.zegoSDKLoaded = true;
      window.zegoSDKLoading = false;
    }
  };

  // Xử lý lỗi khi không tải được SDK
  script.onerror = function () {
    console.error("❌ Không thể tải SDK ZEGO chính thức từ CDN!");

    // Thông báo lỗi cho ứng dụng
    if (typeof window !== "undefined") {
      window.zegoSDKLoading = false;
      window.zegoSDKLoadError = true;

      const zegoErrorEvent = new Event("zegoSDKLoadError");
      window.dispatchEvent(zegoErrorEvent);
    }
  };

  // Thêm script vào document
  if (typeof document !== "undefined") {
    document.head.appendChild(script);
  }
})();
